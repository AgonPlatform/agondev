	.global _vdp_waitKeyUp
	.assume	adl=1
	.section .text

    .include "mos_api.inc"
; ---------------------------------------------
; wait for key up state before returning

_vdp_waitKeyUp:	
	push ix 						; push ix onto the stack

wait:
	ld a, mos_sysvars
	rst.lil $08						; get IX pointer to sysvars	

	ld a, (ix + sysvar_vkeydown)	; get key state
	cp 0							; are keys up, none currently pressed?
	jr nz, wait

	pop ix 				; restore ix from stack
	ret 				; return
